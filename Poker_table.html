<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Poker Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
/* ================= FONTS ================= */
@font-face {
  font-family: "Mattone";
  src: url("./fonts/Mattone-Black.otf") format("opentype");
  font-weight: 900;
  font-style: normal;
}

@font-face {
  font-family: "ClashDisplay";
  src: url("./fonts/ClashDisplay-Regular.otf") format("opentype");
  font-weight: 400;
  font-style: normal;
}

@font-face {
  font-family: "CooperHewitt";
  src: url("./fonts/CooperHewitt-Light.otf") format("opentype");
  font-weight: 300;
  font-style: normal;
}

@font-face {
  font-family: "CooperHewitt";
  src: url("./fonts/CooperHewitt-Book.otf") format("opentype");
  font-weight: 400;
  font-style: normal;
}

@font-face {
  font-family: "CooperHewitt";
  src: url("./fonts/CooperHewitt-Semibold.otf") format("opentype");
  font-weight: 600;
  font-style: normal;
}

/* ================= BASE ================= */
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  background: #180e03;
  color: #e6e6e6;
  font-family: CooperHewitt, system-ui, sans-serif;
}

.app {
  max-width: 900px;
  margin: auto;
  padding: 16px;
}

/* ================= HEADER ================= */
header {
  text-align: center;
  margin-bottom: 22px;
}

header h1 {
  font-family: Mattone, sans-serif;
  font-size: 5rem;
  margin: 0 0 16px;
  color: #ffd737;
}

/* Stage button */
.stage-btn {
  width: 30%;
  padding: 16px;
  border-radius: 999px;
  background: transparent;
  border: 2px solid #76daff;
  color: #76daff;
  font-family: ClashDisplay, sans-serif;
  font-size: 1.2rem;
  cursor: pointer;
  margin: 0 auto;
}

.hand {
  margin-top: 8px;
  font-size: 0.9rem;
  opacity: 0.75;
  font-weight: 300;
}

/* ================= SETUP ================= */
.setup {
  display: flex;
  gap: 10px;
  margin: 18px 0;
}

.setup input {
  flex: 1;
  padding: 12px;
  border-radius: 999px;
  border: none;
  background: #241503;
  color: #fff;
  font-weight: 400;
}

.setup button {
  padding: 12px 18px;
  border-radius: 999px;
  border: none;
  background: #241503;
  color: #fff;
  font-weight: 600;
  cursor: pointer;
}

/* ================= MAIN ================= */
.main {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 16px;
}

/* ================= PLAYERS ================= */
.players {
  background: #241503;
  border-radius: 24px;
  padding: 12px;
}

.player {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 14px;
  margin-bottom: 10px;
  border-radius: 999px;
  background: #180e03;
}

.player:last-child {
  margin-bottom: 0;
}

.player label {
  display: flex;
  align-items: center;
  gap: 12px;
  flex: 1;
}

.player input[type="checkbox"] {
  width: 22px;
  height: 22px;
}

.name {
  font-weight: 400;
  font-size: 1.05rem;
}

.role {
  font-weight: 600;
  font-size: 0.75rem;
  color: #fbbf24;
}

.wins {
  font-weight: 300;
  font-size: 0.75rem;
  opacity: 0.8;
}

/* ================= ACTIONS ================= */
.actions {
  background: #241503;
  border-radius: 24px;
  padding: 12px;
  display: flex;
  flex-direction: column;
  gap: 14px;
}

.actions button {
  padding: 16px;
  border-radius: 999px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  background: #180e03;
}

.confirm {
  color: #22c55e;
  border: 2px solid #22c55e;
}

.undo {
  color: #9ca3af;
  border: 2px solid #9ca3af;
}

.reset {
  color: #ef4444;
  border: 2px solid #ef4444;
}

.remove-player {
  background: #b91c1c;
  border: none;
  padding: 6px 12px;
  border-radius: 999px;
  color: #fff;
  font-size: 0.75rem;
  font-weight: 600;
  cursor: pointer;
}

/* ================= RESPONSIVE ================= */
@media (max-width: 700px) {
  .main {
    grid-template-columns: 1fr;
  }
  .stage-btn {
    width: 100%;
  }
}
</style>
</head>

<body>
<div class="app">

<header>
  <h1>Texas Holdâ€™em</h1>
  <button class="stage-btn" onclick="nextStage()">
    <span id="stage"></span>
  </button>
  <div class="hand">Hand #<span id="handNum">1</span></div>
</header>

<section class="setup">
  <input id="playerName" placeholder="Player name" />
  <button onclick="addPlayer()">Add</button>
</section>

<section class="main">
  <div class="players"></div>
  <div class="actions">
    <button class="confirm" onclick="confirmWinners()">Confirm Winner(s)</button>
    <button class="undo" onclick="undoLastHand()">Undo Hand</button>
    <button class="reset" onclick="resetGame()">Reset Game</button>
  </div>
</section>

</div>

<script>
const stages = [
  "Pre-Flop (Hole Cards)",
  "Small Blind / Big Blind",
  "Burn",
  "Flop",
  "Burn",
  "Turn",
  "Burn",
  "River",
  "Showdown"
];

let players = [];
let dealerIndex = 0;
let handNumber = 1;
let stageIndex = 0;
let history = [];

function loadGame() {
  const d = JSON.parse(localStorage.getItem("pokerGame"));
  if (!d) return;
  players = d.players || [];
  dealerIndex = d.dealerIndex || 0;
  handNumber = d.handNumber || 1;
  stageIndex = d.stageIndex || 0;
  history = d.history || [];
}

function saveGame() {
  localStorage.setItem("pokerGame", JSON.stringify({
    players, dealerIndex, handNumber, stageIndex, history
  }));
}

function addPlayer() {
  const i = document.getElementById("playerName");
  if (!i.value.trim()) return;
  players.push({ name: i.value.trim(), wins: 0 });
  i.value = "";
  saveGame(); render();
}

function removePlayer(i) {
  if (!confirm(`Remove ${players[i].name}?`)) return;
  players.splice(i, 1);
  dealerIndex %= players.length || 1;
  saveGame(); render();
}

function confirmWinners() {
  const checked = [...document.querySelectorAll("input[type=checkbox]:checked")]
    .map(c => +c.dataset.index);
  if (!checked.length) return;

  checked.forEach(i => players[i].wins++);
  history.push({ winners: checked, dealerIndex, stageIndex });

  dealerIndex = (dealerIndex + 1) % players.length;
  handNumber++;
  stageIndex = 0;

  saveGame(); render();
}

function undoLastHand() {
  if (!history.length) return;
  const h = history.pop();
  h.winners.forEach(i => players[i].wins--);
  dealerIndex = h.dealerIndex;
  stageIndex = h.stageIndex;
  handNumber--;
  saveGame(); render();
}

function resetGame() {
  if (!confirm("Reset entire game?")) return;
  players = []; dealerIndex = 0; handNumber = 1; stageIndex = 0; history = [];
  saveGame(); render();
}

function nextStage() {
  stageIndex = (stageIndex + 1) % stages.length;
  saveGame(); render();
}

function render() {
  document.getElementById("handNum").innerText = handNumber;
  document.getElementById("stage").innerText =
    `${stageIndex + 1}. ${stages[stageIndex]}`;

  const list = document.querySelector(".players");
  list.innerHTML = "";

  players.forEach((p, i) => {
    let role = "";
    if (i === dealerIndex) role = "Dealer";
    else if (i === (dealerIndex + 1) % players.length) role = "SB";
    else if (i === (dealerIndex + 2) % players.length) role = "BB";

    list.innerHTML += `
      <div class="player">
        <label>
          <input type="checkbox" data-index="${i}">
          <span class="name">${p.name}</span>
        </label>
        <span class="role">${role}</span>
        <span class="wins">Wins: ${p.wins}</span>
        <button class="remove-player" onclick="removePlayer(${i})">Remove</button>
      </div>
    `;
  });
}

loadGame();
render();
</script>

</body>
</html>
